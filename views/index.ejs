<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mini Whatsapp</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h3>All Chats!</h3>

    <div class="chat-container" id="chat-container">
      <% for(let chat of chats){ %>
      <div class="chat <%= chat.from === 'Me' ? 'sent' : 'received' %>">
        <div class="msg">
          <p class="from">From: <i><%= chat.from %></i></p>
          <p><%= chat.msg %></p>
          <p class="to">Received by: <i><%= chat.to %></i></p>
          <span class="time"
            ><%= chat.created_at.toString().split(" ")[4] %></span
          >
          <div class="msg-actions">
            <form method="GET" action="/chats/<%= chat._id %>/edit">
              <button>Edit</button>
            </form>
            <form method="POST" action="/chats/<%= chat._id %>?_method=DELETE">
              <button>Delete</button>
            </form>
          </div>
        </div>
      </div>
      <% } %>
    </div>

    <form method="GET" action="/chats/new" class="new-chat-btn">
      <button>+</button>
    </form>

    <script>
      // Scroll to bottom on page load
      window.addEventListener("load", function () {
        const chatContainer = document.getElementById("chat-container");
        chatContainer.scrollTo({
          top: chatContainer.scrollHeight,
          behavior: "smooth",
        });
      });
    </script>
  </body>
</html>
